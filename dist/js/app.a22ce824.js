(function(e){function t(t){for(var n,r,a=t[0],c=t[1],l=t[2],u=0,m=[];u<a.length;u++)r=a[u],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&m.push(i[r][0]),i[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(m.length)m.shift()();return s.push.apply(s,l||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],n=!0,a=1;a<o.length;a++){var c=o[a];0!==i[c]&&(n=!1)}n&&(s.splice(t--,1),e=r(r.s=o[0]))}return e}var n={},i={app:0},s=[];function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=n,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var d=c;s.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"04b9":function(e,t,o){},"065ee":function(e,t,o){},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},16:function(e,t){},17:function(e,t){},18:function(e,t){},"1d72":function(e,t,o){},2:function(e,t){},2679:function(e,t,o){"use strict";o("065ee")},3:function(e,t){},"3ab4":function(e,t,o){"use strict";o("c403")},"3f5e":function(module,__webpack_exports__,__webpack_require__){"use strict";var _fetch__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("e1d2"),_config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("da71"),crypto_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("3452"),crypto_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(crypto_js__WEBPACK_IMPORTED_MODULE_2__),ali_oss__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("9b15"),ali_oss__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(ali_oss__WEBPACK_IMPORTED_MODULE_3__),minio__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("ad23"),minio__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(minio__WEBPACK_IMPORTED_MODULE_4__),cos_js_sdk_v5__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("40b3"),cos_js_sdk_v5__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(cos_js_sdk_v5__WEBPACK_IMPORTED_MODULE_5__),buffer_from__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("653c"),buffer_from__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(buffer_from__WEBPACK_IMPORTED_MODULE_6__),uuid__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("ec26"),qiniu_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("f744"),_assets_scripts_tokenTools__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("4e00");function getConfig(e,t){if(e){const e="github"===t?_config__WEBPACK_IMPORTED_MODULE_1__["b"]:_config__WEBPACK_IMPORTED_MODULE_1__["a"],{username:o,repoList:n,branch:i,accessTokenList:s}=e,r=Math.floor(Math.random()*s.length),a=s[r].replace("doocsmd",""),c=Math.floor(Math.random()*n.length),l=n[c];return{username:o,repo:l,branch:i,accessToken:a}}const o=JSON.parse(localStorage.getItem(t+"Config")),n=o.repo.replace(`https://${t}.com/`,"").replace(`http://${t}.com/`,"").replace(t+".com/","").split("/");return{username:n[0],repo:n[1],branch:o.branch||"master",accessToken:o.accessToken}}function getDir(){const e=new Date,t=e.getFullYear(),o=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0");return`${t}/${o}/${n}`}function getDateFilename(e){const t=(new Date).getTime(),o=e.split(".")[1];return`${t}-${Object(uuid__WEBPACK_IMPORTED_MODULE_7__["a"])()}.${o}`}async function ghFileUpload(e,t){var o;const n="default"===localStorage.getItem("imgHost"),{username:i,repo:s,branch:r,accessToken:a}=getConfig(n,"github"),c=getDir(),l=`https://api.github.com/repos/${i}/${s}/contents/${c}/`,d=getDateFilename(t),u=await Object(_fetch__WEBPACK_IMPORTED_MODULE_0__["a"])({url:l+d,method:"put",headers:{Authorization:"token "+a},data:{content:e,branch:r,message:"Upload by "+window.location.href}}),m=`raw.githubusercontent.com/${i}/${s}/${r}/`,p=`fastly.jsdelivr.net/gh/${i}/${s}@${r}/`;return u.content=(null===(o=u.data)||void 0===o?void 0:o.content)||u.content,n?u.content.download_url.replace(m,p):u.content.download_url}async function giteeUpload(e,t){var o;const n="default"===localStorage.getItem("imgHost"),{username:i,repo:s,branch:r,accessToken:a}=getConfig(n,"gitee"),c=getDir(),l=getDateFilename(t),d=`https://gitee.com/api/v5/repos/${i}/${s}/contents/${c}/${l}`,u=await Object(_fetch__WEBPACK_IMPORTED_MODULE_0__["a"])({url:d,method:"POST",data:{content:e,branch:r,access_token:a,message:"Upload by "+window.location.href}});return u.content=(null===(o=u.data)||void 0===o?void 0:o.content)||u.content,encodeURI(u.content.download_url)}function getQiniuToken(e,t,o){const n=JSON.stringify(o),i=Object(_assets_scripts_tokenTools__WEBPACK_IMPORTED_MODULE_9__["base64encode"])(Object(_assets_scripts_tokenTools__WEBPACK_IMPORTED_MODULE_9__["utf16to8"])(n)),s=crypto_js__WEBPACK_IMPORTED_MODULE_2___default.a.HmacSHA1(i,t),r=s.toString(crypto_js__WEBPACK_IMPORTED_MODULE_2___default.a.enc.Base64);return`${e}:${Object(_assets_scripts_tokenTools__WEBPACK_IMPORTED_MODULE_9__["safe64"])(r)}:${i}`}async function qiniuUpload(e){const{accessKey:t,secretKey:o,bucket:n,region:i,path:s,domain:r}=JSON.parse(localStorage.getItem("qiniuConfig")),a=getQiniuToken(t,o,{scope:n,deadline:Math.trunc((new Date).getTime()/1e3)+3600}),c=s?s+"/":"",l=c+getDateFilename(e.name),d=qiniu_js__WEBPACK_IMPORTED_MODULE_8__["upload"](e,l,a,{},{region:i});return new Promise((e,t)=>{d.subscribe({next:e=>{console.log(e)},error:e=>{t(e.message)},complete:t=>{e(`${r}/${t.key}`)}})})}async function aliOSSFileUpload(e,t){const o=getDateFilename(t),{region:n,bucket:i,accessKeyId:s,accessKeySecret:r,cdnHost:a,path:c}=JSON.parse(localStorage.getItem("aliOSSConfig")),l=buffer_from__WEBPACK_IMPORTED_MODULE_6___default()(e,"base64"),d=`${c}/${o}`,u=new ali_oss__WEBPACK_IMPORTED_MODULE_3___default.a({region:n,bucket:i,accessKeyId:s,accessKeySecret:r});try{const e=await u.put(d,l);return""===a?e.url:`${a}/${""===c?o:d}`}catch(m){return Promise.reject(m)}}async function txCOSFileUpload(e){const t=getDateFilename(e.name),{secretId:o,secretKey:n,bucket:i,region:s,path:r,cdnHost:a}=JSON.parse(localStorage.getItem("txCOSConfig")),c=new cos_js_sdk_v5__WEBPACK_IMPORTED_MODULE_5___default.a({SecretId:o,SecretKey:n});return new Promise((o,n)=>{c.putObject({Bucket:i,Region:s,Key:`${r}/${t}`,Body:e},(function(e,i){e?n(e):o(a?""==r?`${a}/${t}`:`${a}/${r}/${t}`:"https://"+i.Location)}))})}async function minioFileUpload(e,t){const o=getDateFilename(t),{endpoint:n,port:i,useSSL:s,bucket:r,accessKey:a,secretKey:c}=JSON.parse(localStorage.getItem("minioConfig")),l=buffer_from__WEBPACK_IMPORTED_MODULE_6___default()(e,"base64"),d={endPoint:n,useSSL:s,accessKey:a,secretKey:c},u=Number(i||0),m=u>0&&80!==u&&443!==u;return m&&(d.port=u),new Promise((e,t)=>{const a=new minio__WEBPACK_IMPORTED_MODULE_4__["Client"](d);try{a.putObject(r,o,l,(function(a){a&&t(a);const c=`${s?"https://":"http://"}${n}${m?":"+i:""}`,l=`${c}/${r}/${o}`;e(l)}))}catch(c){t(c)}})}async function formCustomUpload(content,file){const str=`\n    async (CUSTOM_ARG) => {\n      ${localStorage.getItem("formCustomConfig")}\n    }\n  `;return new Promise((resolve,reject)=>{const exportObj={content:content,file:file,util:{axios:_fetch__WEBPACK_IMPORTED_MODULE_0__["a"],CryptoJS:crypto_js__WEBPACK_IMPORTED_MODULE_2___default(),OSS:ali_oss__WEBPACK_IMPORTED_MODULE_3___default(),COS:cos_js_sdk_v5__WEBPACK_IMPORTED_MODULE_5___default(),Buffer:buffer_from__WEBPACK_IMPORTED_MODULE_6___default(),uuidv4:uuid__WEBPACK_IMPORTED_MODULE_7__["a"],qiniu:qiniu_js__WEBPACK_IMPORTED_MODULE_8__,tokenTools:_assets_scripts_tokenTools__WEBPACK_IMPORTED_MODULE_9__,getDir:getDir,getDateFilename:getDateFilename},okCb:resolve,errCb:reject};eval(str)(exportObj).catch(e=>{console.error(e),reject(e)})})}function fileUpload(e,t){const o=localStorage.getItem("imgHost");switch(!o&&localStorage.setItem("imgHost","default"),o){case"aliOSS":return aliOSSFileUpload(e,t.name);case"minio":return minioFileUpload(e,t.name);case"txCOS":return txCOSFileUpload(t);case"qiniu":return qiniuUpload(t);case"gitee":return giteeUpload(e,t.name);case"github":return ghFileUpload(e,t.name);case"formCustom":return formCustomUpload(e,t);default:return ghFileUpload(e,t.name)}}__webpack_exports__["a"]={fileUpload:fileUpload}},4:function(e,t){},"46cc":function(e,t,o){"use strict";o("b1cf")},"4d32":function(e,t,o){"use strict";o("75fb")},"4e00":function(e,t,o){"use strict";function n(e){var t,o,n,i;for(t="",n=e.length,o=0;o<n;o++)i=e.charCodeAt(o),i>=1&&i<=127?t+=e.charAt(o):i>2047?(t+=String.fromCharCode(224|i>>12&15),t+=String.fromCharCode(128|i>>6&63),t+=String.fromCharCode(128|i>>0&63)):(t+=String.fromCharCode(192|i>>6&31),t+=String.fromCharCode(128|i>>0&63));return t}function i(e){var t,o,n,i,s,r;t="",n=e.length,o=0;while(o<n)switch(i=e.charCodeAt(o++),i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(o-1);break;case 12:case 13:s=e.charCodeAt(o++),t+=String.fromCharCode((31&i)<<6|63&s);break;case 14:s=e.charCodeAt(o++),r=e.charCodeAt(o++),t+=String.fromCharCode((15&i)<<12|(63&s)<<6|(63&r)<<0);break}return t}o.r(t),o.d(t,"utf16to8",(function(){return n})),o.d(t,"utf8to16",(function(){return i})),o.d(t,"base64encode",(function(){return a})),o.d(t,"base64decode",(function(){return c})),o.d(t,"safe64",(function(){return l}));const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",r=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function a(e){var t,o,n,i,r,a;n=e.length,o=0,t="";while(o<n){if(i=255&e.charCodeAt(o++),o==n){t+=s.charAt(i>>2),t+=s.charAt((3&i)<<4),t+="==";break}if(r=e.charCodeAt(o++),o==n){t+=s.charAt(i>>2),t+=s.charAt((3&i)<<4|(240&r)>>4),t+=s.charAt((15&r)<<2),t+="=";break}a=e.charCodeAt(o++),t+=s.charAt(i>>2),t+=s.charAt((3&i)<<4|(240&r)>>4),t+=s.charAt((15&r)<<2|(192&a)>>6),t+=s.charAt(63&a)}return t}function c(e){var t,o,n,i,s,a,c;a=e.length,s=0,c="";while(s<a){do{t=r[255&e.charCodeAt(s++)]}while(s<a&&-1==t);if(-1==t)break;do{o=r[255&e.charCodeAt(s++)]}while(s<a&&-1==o);if(-1==o)break;c+=String.fromCharCode(t<<2|(48&o)>>4);do{if(n=255&e.charCodeAt(s++),61==n)return c;n=r[n]}while(s<a&&-1==n);if(-1==n)break;c+=String.fromCharCode((15&o)<<4|(60&n)>>2);do{if(i=255&e.charCodeAt(s++),61==i)return c;i=r[i]}while(s<a&&-1==i);if(-1==i)break;c+=String.fromCharCode((3&n)<<6|i)}return c}function l(e){return e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_"),e}},5:function(e,t){},"56d7":function(e,t,o){"use strict";o.r(t);var n=o("2b0e"),i=o("5c96"),s=o.n(i),r=o("be92");o("0fae"),o("a7be"),o("8d7e"),o("90ba"),o("1d72"),o("7b00"),o("959b"),o("10b2"),o("8c33"),o("31c5"),o("9b74"),o("111b");n["default"].component(i["Message"].name,i["Message"]),n["default"].prototype.$loading=i["Loading"].service,n["default"].prototype.$message=i["Message"];var a=function(){var e=this,t=e._self._c,o=e._self._setupProxy;return t("div",{attrs:{id:"app"}},[t(o.CodemirrorEditor)],1)},c=[],l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("el-container",[t("el-header",{staticClass:"editor__header"},[t("editor-header",{ref:"header",on:{addFormat:e.addFormat,formatContent:e.formatContent,refresh:e.onEditorRefresh,cssChanged:e.cssChanged,"import-md":e.importMD,download:e.downloadEditorContent,export:e.exportEditorContent,showCssEditor:function(t){e.showCssEditor=!e.showCssEditor},"show-dialog-form":function(t){e.insertFormDialogVisible=!0},"show-dialog-upload-img":function(t){e.dialogUploadImgVisible=!0},startCopy:function(t){e.isCoping=!0,e.backLight=!0},endCopy:e.endCopy}})],1),t("el-main",{staticClass:"main-body"},[t("el-row",{staticClass:"main-section"},[t("el-col",{ref:"codeMirrorWrapper",staticClass:"codeMirror-wrapper",attrs:{span:12},nativeOn:{contextmenu:function(t){return t.preventDefault(),e.openMenu.apply(null,arguments)}}},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.source,expression:"source"}],attrs:{id:"editor",type:"textarea",placeholder:"Your markdown text here."},domProps:{value:e.source},on:{input:function(t){t.target.composing||(e.source=t.target.value)}}})]),t("el-col",{ref:"preview",staticClass:"preview-wrapper",attrs:{span:12,id:"preview"}},[t("section",{attrs:{id:"output-wrapper"}},[t("div",{staticClass:"preview"},[t("section",{attrs:{id:"output"},domProps:{innerHTML:e._s(e.output)}})])])]),t("css-editor",{attrs:{"show-css-editor":e.showCssEditor},on:{showCssEditor:function(t){e.showCssEditor=!e.showCssEditor}}})],1)],1)],1),t("upload-img-dialog",{attrs:{visible:e.dialogUploadImgVisible},on:{close:function(t){e.dialogUploadImgVisible=!1},beforeUpload:e.beforeUpload,uploadImage:e.uploadImage,uploaded:e.uploaded}}),t("insert-form-dialog",{attrs:{visible:e.insertFormDialogVisible},on:{close:function(t){e.insertFormDialogVisible=!1}}}),t("right-click-menu",{attrs:{visible:e.rightClickMenuVisible,left:e.mouseLeft,top:e.mouseTop},on:{menuTick:e.onMenuEvent,closeMenu:function(t){e.rightClickMenuVisible=!1}}}),t("run-loading")],1)},d=[],u=(o("a1f0"),o("14d9"),o("7c5c")),m=o.n(u),p=o("56b3"),f=o.n(p),h={pageThemes:[{label:"默认主题",value:"default"},{label:"雅致留白",value:"zine"}],builtinFonts:[{label:"无衬线",value:"-apple-system-font,BlinkMacSystemFont, Helvetica Neue, PingFang SC, Hiragino Sans GB , Microsoft YaHei UI , Microsoft YaHei ,Arial,sans-serif",desc:"Abc"},{label:"衬线",value:"Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif",desc:"Abc"}],sizeOption:[{label:"12px",value:"12px",desc:"更小"},{label:"13px",value:"13px",desc:"稍小"},{label:"14px",value:"14px",desc:"推荐"},{label:"15px",value:"15px",desc:"稍大"},{label:"16px",value:"16px",desc:"更大"}],colorOption:[{label:"经典蓝",value:"rgba(15, 76, 129, 1)",desc:"最新流行"},{label:"翡翠绿",value:"rgba(0, 152, 116, 1)",desc:"优雅清新"},{label:"活力橘",value:"rgba(250, 81, 81, 1)",desc:"热情活泼"}],codeThemeOption:[{label:"github",value:"https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/github.min.css",desc:"light"},{label:"solarized-light",value:"https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/solarized-light.min.css",desc:"light"},{label:"atom-one-dark",value:"https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/atom-one-dark.min.css",desc:"dark"},{label:"obsidian",value:"https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/obsidian.min.css",desc:"dark"},{label:"vs2015",value:"https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/vs2015.min.css",desc:"dark"}],form:{rows:1,cols:1}},g=o("1487"),b=o.n(g),_=o("f9ff"),w=o.n(_);m.a.use(w()({throwOnError:!1,output:"html"}));class C{constructor(e){this.opts=e;let t=[],o=0,n=new Map,i=(e,t)=>Object.assign({},e,t);this.buildTheme=e=>{let t={},o=i(e.BASE,{});for(let s in e.inline)if(e.inline.hasOwnProperty(s)){let o=e.inline[s];t[s]=i(e.BASE,o)}let n=i(o,{});for(let s in e.block)if(e.block.hasOwnProperty(s)){let o=e.block[s];t[s]=i(n,o)}return t};let s=(e,t)=>{let o=[],i=n[e];if(!i)return"";for(const n in i)o.push(n+":"+i[n]);return`style="${o.join(";")+(t||"")}"`},r=(e,n)=>(t.push([++o,e,n]),o);this.buildFootnotes=()=>{let e=t.map(e=>e[1]===e[2]?`<code style="font-size: 90%; opacity: 0.6;">[${e[0]}]</code>: <i>${e[1]}</i><br/>`:`<code style="font-size: 90%; opacity: 0.6;">[${e[0]}]</code> ${e[1]}: <i>${e[2]}</i><br/>`);return e.length?`<h4 ${s("h4")}>引用链接</h4><p ${s("footnotes")}>${e.join("\n")}</p>`:""},this.buildAddition=()=>"\n            <style>\n            .preview-wrapper pre::before {\n                position: absolute;\n                top: 0;\n                right: 0;\n                color: #ccc;\n                text-align: center;\n                font-size: 0.8em;\n                padding: 5px 10px 0;\n                line-height: 15px;\n                height: 15px;\n                font-weight: 600;\n            }\n            </style>\n        ",this.setOptions=e=>{this.opts=i(this.opts,e)},this.hasFootnotes=()=>0!==t.length,this.getRenderer=e=>{t=[],o=0,n=this.buildTheme(this.opts.theme);let i=new u["Renderer"];return i.heading=(e,t)=>{switch(t){case 1:return`<h1 ${s("h1")}>${e}</h1>`;case 2:return`<h2 ${s("h2")}>${e}</h2>`;case 3:return`<h3 ${s("h3")}>${e}</h3>`;default:return`<h4 ${s("h4")}>${e}</h4>`}},i.paragraph=e=>-1!=e.indexOf("<figure")&&-1!=e.indexOf("<img")?e:""===e.replace(/ /g,"")?"":`<p ${s("p")}>${e}</p>`,i.blockquote=e=>(e=e.replace(/<p.*?>/g,`<p ${s("blockquote_p")}>`),`<blockquote ${s("blockquote")}>${e}</blockquote>`),i.code=(e,t)=>t.startsWith("mermaid")?(setTimeout(()=>{var e;null===(e=window.mermaid)||void 0===e||e.run()},0),`<center><pre class="mermaid">${e}</pre></center>`):(t=b.a.getLanguage(t)?t:"plaintext",e=b.a.highlight(e,{language:t}).value,e=e.replace(/\r\n/g,"<br/>").replace(/\n/g,"<br/>").replace(/(>[^<]+)|(^[^<]+)/g,(function(e){return e.replace(/\s/g,"&nbsp;")})),`<pre class="hljs code__pre" ${s("code_pre")}><code class="prettyprint language-${t}" ${s("code")}>${e}</code></pre>`),i.codespan=(e,t)=>`<code ${s("codespan")}>${e}</code>`,i.listitem=e=>`<li ${s("listitem")}><span><%s/></span>${e}</li>`,i.list=(e,t,o)=>{e=e.replace(/<\/*p .*?>/g,"").replace(/<\/*p>/g,"");let n=e.split("<%s/>");if(!t)return e=n.join("• "),`<ul ${s("ul")}>${e}</ul>`;e=n[0];for(let i=1;i<n.length;i++)e=e+i+". "+n[i];return`<ol ${s("ol")}>${e}</ol>`},i.image=(e,t,o)=>{let n="";o&&(n=`<figcaption ${s("figcaption")}>${o}</figcaption>`);let i=s("figure"),r=s("image");return`<figure ${i}><img ${r} src="${e}" title="${t}" alt="${o}"/>${n}</figure>`},i.link=(t,o,n)=>{if(t.startsWith("https://mp.weixin.qq.com"))return`<a href="${t}" title="${o||n}" ${s("wx_link")}>${n}</a>`;if(t===n)return n;if(e){let e=r(o||n,t);return`<span ${s("link")}>${n}<sup>[${e}]</sup></span>`}return`<span ${s("link")}>${n}</span>`},i.strong=e=>`<strong ${s("strong")}>${e}</strong>`,i.em=e=>`<span style="font-style: italic;">${e}</span>`,i.table=(e,t)=>`<section style="padding:0 8px;"><table class="preview-table"><thead ${s("thead")}>${e}</thead><tbody>${t}</tbody></table></section>`,i.tablecell=(e,t)=>`<td ${s("td")}>${e}</td>`,i.hr=()=>`<hr ${s("hr")}>`,i}}}var k=C,y='# 示例文章：Google 搜索的即时自动补全功能究竟是如何“工作”的？\n\n> Google 搜索**自动补全功能**的强大，相信不少朋友都能感受到，它帮助我们更快地“补全”我们所要输入的搜索关键字。那么，它怎么知道我们要输入什么内容？它又是如何工作的？在这篇文章里，我们一起来看看。\n\n## 使用自动补全\n\nGoogle 搜索的自动补全功能可以在 Google 搜索应用的大多数位置使用，包括 [Google](https://www.google.com/) 主页、适用于 IOS 和 Android 的 Google 应用，我们只需要在 Google 搜索框上开始键入关键字，就可以看到联想词了。\n\n![](https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/gh/doocs/md/images/1648303019705-c161ce00-d245-446a-b81c-42ec91474a40.gif)\n\n在上图示例中，我们可以看到，输入关键字 `juej`，Google 搜索会联想到“掘金”、“掘金小册”、“绝句”等等，好处就是，我们无须输入完整的关键字即可轻松完成针对这些 topics 的搜索。\n\n谷歌搜索的自动补全功能对于使用移动设备的用户来说特别有用，用户可以轻松在难以键入的小屏幕上完成搜索。当然，对于移动设备用户和台式机用户而言，这都节省了大量的时间。根据 Google 官方报告，自动补全功能可以减少大约 25% 的打字，累积起来，预计每天可以节省 200 多年的打字时间。是的，每天！\n\n> 注意，本文所提到的“**联想词**”与“**预测**”，是同一个意思。\n\n## 基于“预测”而非“建议”\n\nGoogle 官方将自动补全功能称之为“预测”，而不是“建议”，为什么呢？其实是有充分理由的。自动补全功能是为了**帮助用户完成他们打算进行的搜索**，而不是建议用户要执行什么搜索。\n\n那么，Google 是如何确定这些“预测”的？其实，Google 会根据趋势搜索 [trends](https://trends.google.com/trends/?geo=US) 给到我们这些“预测”。简单来说，哪个热门、哪个搜索频率高，就更可能推给我们。当然，这也与我们当前所处的位置以及我们的搜索历史相关。\n\n另外，这些“预测”也会随着我们键入的关键字的变更而更改。例如，当我们把键入的关键字从 `juej` 更改为 `juex` 时，与“掘金”相关的预测会“消失”，同时，与“觉醒”、“决心”相关联的词会出现。\n\n![](https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/gh/doocs/md/images/1648303068169-386a99cb-143b-4ded-a859-1b7a4c4b5bd3.gif)\n\n## 为什么看不到某些联想词？\n\n如果我们在输入某个关键字时看不到联想词，那么表明 Google 的算法可能检测到：\n\n- 这个关键字不是热门字词；\n- 搜索的字词太新了，我们可能需要等待几天或几周才能看到联想词；\n- 这是一个侮辱性或敏感字词，这个搜索字词违反了 Google 的相关政策。更加详细的情况，可以了解 [Google 搜索自动补全政策](https://support.google.com/websearch/answer/7368877)。\n\n## 为什么会看到某些不当的联想词？\n\nGoogle 拥有专门设计的系统，可以自动捕获不适当的预测结果而不显示出来。然而，Google 每天需要处理数十亿次搜索，这意味着 Google 每天会显示数十亿甚至上百亿条预测。再好的系统，也可能存在缺陷，不正确的预测也可能随时会出现。\n\n我们作为 Google 搜索的用户，如果认定某条预测违反了相关的搜索自动补全政策，可以进行举报反馈，点击右下角“**举报不当的联想查询**”并勾选相关选项即可。\n\n![](https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/gh/doocs/md/images/1648303098026-cac215dc-42c9-462a-a359-dcfb12ed3234.gif)\n\n## 如何实现自动补全算法？\n\n目前，Google 官方似乎并没有公开搜索自动补全的算法实现，但是业界在这方面已经有了不少研究。\n\n一个好的自动补全器必须是快速的，并且在用户键入下一个字符后立即更新联想词列表。**自动补全器的核心是一个函数，它接受输入的前缀，并搜索以给定前缀开头的词汇或语句列表**。通常来说，只需要返回少量的数目即可。\n\n接下来，我们先从一个简单且低效的实现开始，并在此基础上逐步构建更高效的方法。\n\n### 词汇表实现\n\n一个**简单粗暴的实现方式**是：顺序查找词汇表，依次检查每个词汇，看它是否以给定的前缀开头。\n\n但是，此方法需要将前缀与每个词汇进行匹配检查，若词汇量较少，这种方式可能勉强行得通。但是，如果词汇量规模较大，效率就太低了。\n\n一个**更好的实现方式是**：让词汇按字典顺序排序。借助二分搜索算法，可以快速搜索有序词汇表中的前缀。由于二分搜索的每一步都会将搜索的范围减半，因此，总的搜索时间与词汇表中单词数量的对数成正比，即时间复杂度是 `O(log N)`。二分搜索的性能很好，但有没有更好的实现呢？当然有，往下看。\n\n### 前缀树实现\n\n通常来说，许多词汇都以相同的前缀开头，比如 `need`、`nested` 都以 `ne` 开头，`seed`、`speed` 都以 `s` 开头。要是为每个单词分别存储公共前缀似乎很浪费。\n\n\n![](https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/gh/doocs/md/images/1648303128008-93cf798d-2662-4eec-8f80-2e07436aebfe.png)\n\n\n前缀树是一种利用公共前缀来加速补全速度的数据结构。前缀树在节点树中排列一组单词，单词沿着从根节点到叶子节点的路径存储，树的层次对应于前缀的字母位置。\n\n前缀的补全是顺着前缀定义的路径来查找的。例如，在上图的前缀树中，前缀 `ne` 对应于从子节点取左边缘 `N` 和唯一边缘 `E` 的路径。然后可以通过继续遍历从 `E` 节点可以达到的所有叶节点来生成补全列表。在图中，`ne` 的补全可以是两个分支：`-ed` 和 `-sted`。如果在数中找不到由前缀定义的路径，则说明词汇表中不包含以该前缀开头的单词。\n\n### 有限状态自动机(DFA)实现\n\n前缀树可以有效处理公共前缀，但是，对于其他共享词部分，仍会分别存储在每个分支中。比如，后缀 `ed`、`ing`、`tion` 在英文单词中特别常见。在上一个例子中，`e`、`d` 分别存放在了每一个分支上。\n\n有没有一种方法可以更加节省存储空间呢？有的，那就是 DFA。\n\n<center>\n<img src="https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/gh/doocs/md/images/1648303158478-66a96e2d-6424-43d6-8cb3-2f7a39f960b8.gif" style="width: 50%;"></center>\n\n在上面的例子中，单词 `need`、`nested`、`seed` 和 `speed` 仅由 9 个节点组成，而上一张图中的前缀树包含了 17 个节点。\n\n可以看出，最小化前缀树 DFA 可以在很大程度上减少数据结构的大小。即使词汇量很大，最小化 DFA 通常也适合在内存中存储，避免昂贵的磁盘访问是实现快速自动补全的关键。\n\n### 一些扩展\n\n上面介绍了如何利用合理的数据结构实现基本的自动补全功能。这些数据结构可以通过多种方式进行扩展，从而改善用户体验。\n\n通常，满足特定前缀的词汇可能很多，而用户界面上能够显示的却不多，我们更希望能显示最常搜索或者最有价值的词汇。这通常可以通过为词汇表中的每个单词增加一个代表单词值的**权重** `weight`，并且按照权重高低来排序自动补全列表。\n\n- 对于排序后的词汇表来说，在词汇表每个元素上增加 `weight` 属性并不难；\n- 对于前缀树来说，将 `weight` 存储在叶子节点中，也是很简单的一个实现；\n- 对于 `DFA` 来说，则较为复杂。因为一个叶子节点可以通过多条路径到达。一种解决方案是将权重关联到路径而不是叶子节点。\n\n目前有不少开源库都提供了这个功能，比如主流的搜索引擎框架 [Elasticsearch](https://www.elastic.co/products/elasticsearch)、[Solr](https://lucene.apache.org/solr/) 等，基于此，我们可以实现高效而强大的自动补全功能。\n\n#### 推荐阅读\n\n- [阿里又一个 20k+ stars 开源项目诞生，恭喜 fastjson！](https://mp.weixin.qq.com/s/RNKDCK2KoyeuMeEs6GUrow)\n- [刷掉 90% 候选人的互联网大厂海量数据面试题（附题解 + 方法总结）](https://mp.weixin.qq.com/s/rjGqxUvrEqJNlo09GrT1Dw)\n- [好用！期待已久的文本块功能究竟如何在 Java 13 中发挥作用？](https://mp.weixin.qq.com/s/kalGv5T8AZGxTnLHr2wDsA)\n- [2019 GitHub 开源贡献排行榜新鲜出炉！微软谷歌领头，阿里跻身前 12！](https://mp.weixin.qq.com/s/_q812aGD1b9QvZ2WFI0Qgw)\n\n---\n\n欢迎关注我的公众号“**Doocs**”，原创技术文章第一时间推送。\n\n<center>\n    <img src="https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/gh/doocs/md/images/1648303220922-7e14aefa-816e-44c1-8604-ade709ca1c69.png" style="width: 100px;">\n</center>\n',E="/*\n  按Ctrl/Command+F可格式化\n*/\n/* 一级标题样式 */\nh1 {\n}\n/* 二级标题样式 */\nh2 {\n}\n/* 三级标题样式 */\nh3 {\n}\n/* 四级标题样式 */\nh4 {\n}\n/* 图片样式 */\nimage {\n}\n/* 引用样式 */\nblockquote {\n}\n/* 引用段落样式 */\nblockquote_p {\n}\n/* 段落样式 */\np {\n}\n/* 分割线样式 */\nhr {\n}\n/* 行内代码样式 */\ncodespan {\n}\n/* 粗体样式 */\nstrong {\n}\n/* 链接样式 */\nlink {\n}\n/* 微信链接样式 */\nwx_link {\n}\n/* 有序列表样式 */\nol {\n}\n/* 无序列表样式 */\nul {\n}\n/* 列表项样式 */\nli {\n}\n/* 代码块样式 */\ncode {\n}\n",v=(o("88a7"),o("271a"),o("5494"),o("325b1")),x=o.n(v),O=o("d238"),$=o.n(O),S=o("4fc3"),T=o.n(S);let M="#3f3f3f",D="rgba(0, 152, 116, 0.9)";var P={wrapper:{"font-size":"14px"},BASE:{"font-family":"PingFangSC","text-align":"left","line-height":"1.75"},block:{h1:{"font-size":"1.2em","text-align":"center","font-weight":"bold",display:"table",margin:"2em auto 1em",padding:"1em 1em 0 1em",color:M},h2:{"font-size":"1.2em","text-align":"center","font-weight":"bold",display:"table",margin:"3em auto 2em",padding:"0 0.5em",background:D,color:"#fff"},h3:{"font-weight":"bold","font-size":"1.1em",margin:"0 8px 1em 8px","line-height":"1.2","padding-left":"8px","border-left":"3px solid "+D,color:M},h4:{"font-weight":"bold","font-size":"1em",margin:"0 8px","line-height":2,color:D},p:{margin:"0 8px 2em 8px",color:M},blockquote:{"font-style":"normal","border-left":"none",padding:"1em","border-radius":"8px",color:"rgba(0,0,0,0.5)",background:"#f7f7f7",margin:"2em 8px"},blockquote_p:{"letter-spacing":"0.1em",color:"rgb(80, 80, 80)","font-size":"1em",display:"block"},code_pre:{"font-size":"14px","overflow-x":"auto","border-radius":"8px",padding:"1em","line-height":"1.5",margin:"10px 8px"},code:{margin:0,"white-space":"nowrap","font-family":"Menlo, Operator Mono, Consolas, Monaco, monospace"},image:{"border-radius":"4px",display:"block",margin:"0.1em auto 0.5em",width:"100% !important"},ol:{"margin-left":"0","padding-left":"1em",color:M},ul:{"margin-left":"0","padding-left":"1em","list-style":"circle",color:M},footnotes:{margin:"0.5em 8px","font-size":"80%",color:M},figure:{margin:"1.5em 8px",color:M},hr:{"border-style":"solid","border-width":"1px 0 0","border-color":"rgba(0,0,0,0.1)","-webkit-transform-origin":"0 0","-webkit-transform":"scale(1, 0.5)","transform-origin":"0 0",transform:"scale(1, 0.5)"}},inline:{listitem:{"text-indent":"-1em",display:"block",margin:"0.2em 8px",color:M},codespan:{"font-size":"90%",color:"#d14",background:"rgba(27,31,35,.05)",padding:"3px 5px","border-radius":"4px","word-break":"break-all"},link:{color:"#576b95"},wx_link:{color:"#576b95","text-decoration":"none"},strong:{color:D,"font-weight":"bold"},table:{"border-collapse":"collapse","text-align":"center",margin:"1em 8px",color:M},thead:{background:"rgba(0, 0, 0, 0.05)","font-weight":"bold",color:M},td:{border:"1px solid #dfdfdf",padding:"0.25em 0.5em",color:M},footnote:{"font-size":"12px",color:M},figcaption:{"text-align":"center",color:"#888","font-size":"0.8em"}}};const I=(e,t)=>{const o=JSON.parse(JSON.stringify(e));return t&&(o.block.h1["border-bottom"]="2px solid "+t,o.block.h2["background"]=t,o.block.h3["border-left"]="3px solid "+t,o.block.h4["color"]=t,o.inline.strong["color"]=t),o};function A(e){return t=>I(e,t)}function R(e){return function(t){const o=JSON.parse(JSON.stringify(e));return o.block.h1["font-size"]=1.14*t+"px",o.block.h2["font-size"]=1.1*t+"px",o.block.h3["font-size"]=t+"px",o.block.h4["font-size"]=t+"px",o}}A(P),R(P);function j(e,t){const o=I(t);return o.block.h1=Object.assign(o.block.h1,e.h1),o.block.h2=Object.assign(o.block.h2,e.h2),o.block.h3=Object.assign(o.block.h3,e.h3),o.block.h4=Object.assign(o.block.h4,e.h4),o.block.code=Object.assign(o.block.code,e.code),o.block.p=Object.assign(o.block.p,e.p),o.block.hr=Object.assign(o.block.hr,e.hr),o.block.blockquote=Object.assign(o.block.blockquote,e.blockquote),o.block.blockquote_p=Object.assign(o.block.blockquote_p,e.blockquote_p),o.block.image=Object.assign(o.block.image,e.image),o.inline.strong=Object.assign(o.inline.strong,e.strong),o.inline.codespan=Object.assign(o.inline.codespan,e.codespan),o.inline.link=Object.assign(o.inline.link,e.link),o.inline.wx_link=Object.assign(o.inline.wx_link,e.wx_link),o.block.ul=Object.assign(o.block.ul,e.ul),o.block.ol=Object.assign(o.block.ol,e.ol),o.inline.listitem=Object.assign(o.inline.listitem,e.li),o}function L(e){let t,o;while(-1!==(t=e.indexOf("/*"))&&-1!==(o=e.indexOf("*/")))e=e.substring(0,t)+e.substring(o+2);let n={};while(e.length>0&&-1!==e.indexOf("{")&&-1!==e.indexOf("}")){const t=e.indexOf("{"),o=e.indexOf("}");function i(e){let t={};return e.forEach(e=>{const o=e.indexOf(":"),n=e.substring(0,o).trim();t[n]=e.substring(o+1).trim()}),t}let s=e.substring(t+1,o).split(";").map(e=>e.trim()).filter(e=>e.length>0);s=i(s);let r=e.substring(0,t).split(",").map(e=>e.trim());r.forEach(e=>{n[e]||(n[e]={}),Object.keys(s).forEach(t=>{n[e][t]=s[t]})}),e=e.slice(o+1).trim()}return n}function U(e,t){const o=e.getValue(0);o?localStorage.setItem(t,o):localStorage.removeItem(t)}function B(e){return x.a.format(e,{parser:"markdown",plugins:[T.a]})}function q(e){return x.a.format(e,{parser:"css",plugins:[$.a]})}function F(e){const t=document.createElement("a");t.download="content.md",t.style.display="none";const o=new Blob([e]);t.href=URL.createObjectURL(o),document.body.appendChild(t),t.click(),document.body.removeChild(t)}function K(){const e=document.querySelector("#output");i(e);const t=e.innerHTML,o=document.createElement("a");o.download="content.html",o.style.display="none";let n=new Blob([`<html><head><meta charset="utf-8" /></head><body><div style="width: 750px; margin: auto;">${t}</div></body></html>`]);function i(e){function t(e,t=["width","height"]){const o=getComputedStyle(e,null);return Object.entries(o).filter(([e])=>o.getPropertyValue(e)&&!t.includes(e)).map(([e,t])=>`${e}:${t};`).join("")}switch(!0){case o(e):case n(e):case s(e):e.setAttribute("style",t(e));default:}function o(e){return"PRE"===e.tagName&&Array.from(e.classList).includes("code__pre")}function n(e){return"CODE"===e.tagName&&Array.from(e.classList).includes("prettyprint")}function s(e){return"SPAN"===e.tagName&&(n(e.parentElement)||n(e.parentElement.parentElement))}e.children.length&&Array.from(e.children).forEach(e=>i(e))}o.href=URL.createObjectURL(n),document.body.appendChild(o),o.click(),document.body.removeChild(o)}function H({data:e,rows:t,cols:o}){let n="";for(let i=0;i<t+2;++i){n+="| ";const t=[];for(let n=0;n<o;++n){const o=i>1?i-1:i;t.push(1===i?"---":e[`k_${o}_${n}`]||"     ")}n+=t.join(" | "),n+=" |\n"}return n}function G(e){return new Promise((t,o)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>t(n.result.split(",").pop()),n.onerror=e=>o(e)})}function W(e){const t=/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(e.name);if(!t)return{ok:!1,msg:"请上传 JPG/PNG/GIF 格式的图片"};const o=10,n=e.size/1024/1024<=o;return n?{ok:!0}:{ok:!1,msg:`由于公众号限制，图片大小不能超过 ${o}M`}}o("0b16");let N="#202020";var z={wrapper:{"font-size":"15px",margin:"-20px",padding:"30px",background:"url(https://raw.githubusercontent.com/shifan6/resource/master/2023/12/27/1703662645913-f51380ae-762f-47a6-9c9c-0a890961e53f.jpg) 0 0 repeat","background-size":"552px 552px"},BASE:{"font-family":"PingFangSC-Light","text-align":"left","line-height":"2"},block:{h1:{"font-size":"1.2em","text-align":"center","font-weight":"bold",display:"table",margin:"2em auto 1em",padding:"1em 1em 0 1em",color:N},h2:{"font-size":"1.2em","text-align":"center","font-weight":"bold",display:"table",margin:"3em auto 2em",padding:"0 0.5em"},h3:{"font-weight":"bold","font-size":"1.1em",margin:"2em 0","text-align":"center",color:N},h4:{"font-weight":"bold","font-size":"1em",margin:"0 8px"},p:{margin:"0 8px 2em 8px",color:N},blockquote:{"font-style":"normal","border-left":"none",padding:"1em","border-radius":"8px",color:"rgba(0,0,0,0.5)",background:"#f7f7f7",margin:"2em 8px"},blockquote_p:{"letter-spacing":"0.1em",color:"rgb(80, 80, 80)","font-size":"1em",display:"block"},code_pre:{"font-size":"14px","overflow-x":"auto","border-radius":"8px",padding:"1em","line-height":"1.5",margin:"10px 8px"},code:{margin:0,"white-space":"nowrap","font-family":"Menlo, Operator Mono, Consolas, Monaco, monospace"},image:{"border-radius":"4px",display:"block",margin:"0.1em auto 0.5em",width:"100% !important"},ol:{"margin-left":"0","padding-left":"1em",color:N},ul:{"margin-left":"0","padding-left":"1em","list-style":"circle",color:N},footnotes:{margin:"0.5em 8px","font-size":"80%",color:N},figure:{margin:"1.5em 8px",color:N},hr:{"border-style":"solid","border-width":"1px 0 0","border-color":"rgba(0,0,0,0.1)","-webkit-transform-origin":"0 0","-webkit-transform":"scale(1, 0.5)","transform-origin":"0 0",transform:"scale(1, 0.5)"}},inline:{listitem:{"text-indent":"-1em",display:"block",margin:"0.2em 8px",color:N},codespan:{"font-size":"90%",color:"#d14",background:"rgba(27,31,35,.05)",padding:"3px 5px","border-radius":"4px","word-break":"break-all"},link:{color:"#576b95"},wx_link:{color:"#576b95","text-decoration":"none"},strong:{color:"rgba(15, 76, 129, 0.9)","font-weight":"bold"},table:{"border-collapse":"collapse","text-align":"center",margin:"1em 8px",color:N},thead:{background:"rgba(0, 0, 0, 0.05)","font-weight":"bold",color:N},td:{border:"1px solid #dfdfdf",padding:"0.25em 0.5em",color:N},footnote:{"font-size":"12px",color:N},figcaption:{"text-align":"center",color:"#888","font-size":"0.8em"}}};const V=f.a.keyMap["default"],J=V===f.a.keyMap["macDefault"]?"Cmd":"Ctrl",Y=Object(r["c"])("store",{state:()=>({themes:{default:P,zine:z},wxRenderer:null,output:"",html:"",editor:null,cssEditor:null,currentPageTheme:"default",citeStatus:!1}),actions:{setEditorValue(e){this.editor.setValue(e)},setCssEditorValue(e){this.cssEditor.setValue(e)},setWxRendererOptions(e){this.wxRenderer.setOptions(e)},setCiteStatus(e){this.citeStatus=e,localStorage.setItem("citeStatus",e)},setCurrentPageTheme(e){this.currentPageTheme=e,localStorage.setItem("pageTheme",e)},initEditorState(){this.currentPageTheme=localStorage.getItem("pageTheme")||h.pageThemes[0].value,this.citeStatus="true"===localStorage.getItem("citeStatus"),this.wxRenderer=new k({theme:this.themes[this.currentPageTheme]})},initEditorEntity(){const e=document.getElementById("editor");e.value||(e.value=localStorage.getItem("__editor_content")||B(y)),this.editor=f.a.fromTextArea(e,{mode:"text/x-markdown",theme:"xq-light",lineNumbers:!1,lineWrapping:!0,styleActiveLine:!0,autoCloseBrackets:!0,extraKeys:{[J+"-F"]:function(e){const t=B(e.getValue(0));localStorage.setItem("__editor_content",t),e.setValue(t)},[J+"-B"]:function(e){const t=e.getSelection();e.replaceSelection(`**${t}**`)},[J+"-D"]:function(e){const t=e.getSelection();e.replaceSelection(`~~${t}~~`)},[J+"-I"]:function(e){const t=e.getSelection();e.replaceSelection(`*${t}*`)},[J+"-K"]:function(e){const t=e.getSelection();e.replaceSelection(`[${t}]()`)},[J+"-L"]:function(e){const t=e.getSelection();e.replaceSelection(`\`${t}\``)}}})},initCssEditorEntity(){const e=document.getElementById("cssEditor");e.value||(e.value=localStorage.getItem("__css_content")||E),this.cssEditor=f.a.fromTextArea(e,{mode:"css",theme:"style-mirror",lineNumbers:!1,lineWrapping:!0,matchBrackets:!0,autofocus:!0,extraKeys:{[J+"-F"]:function(e){const t=q(e.getValue(0));localStorage.setItem("__css_content",t),e.setValue(t)},[J+"-S"]:function(e){}}})},editorRefresh(){const e=this.wxRenderer.getRenderer(this.citeStatus);u["marked"].setOptions({renderer:e});let t=u["marked"].parse(this.editor.getValue(0));t=t.replace(/(style=".*?)"/,'$1;margin-top: 0"'),this.citeStatus&&(t+=this.wxRenderer.buildFootnotes(),t+=this.wxRenderer.buildAddition());const o=this.themes[this.currentPageTheme];if(o.wrapper){const e=o.wrapper;let n="";for(let t in e)n+=`${t}: ${e[t]}; `;t=`<div style="${n}">${t}</div>`}this.output=t}}});var Q=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"header-container is-dark"},[t("div",{staticClass:"dropdowns"},[t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 文件"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.refClick.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-upload2"}),e._v(" 导入 .md "),t("input",{ref:"fileInput",attrs:{hidden:"",type:"file",accept:".md"}})]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.$emit("download")}}},[t("i",{staticClass:"el-icon-download"}),e._v(" 导出 .md ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.$emit("export")}}},[t("i",{staticClass:"el-icon-document"}),e._v(" 导出 .html ")])],1)],1),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 格式"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.formatItems,(function({label:o,kbd:n,emitArgs:i}){return t("el-dropdown-item",{key:n,staticClass:"format-item",nativeOn:{click:function(t){return e.$emit(...i)}}},[e._v(" "+e._s(o)+" "),t("kbd",[e._v(e._s(n))])])})),1)],1),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 编辑"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.$emit("show-dialog-upload-img")}}},[t("i",{staticClass:"el-icon-upload"}),e._v(" 上传图片 ")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.$emit("show-dialog-form")}}},[t("i",{staticClass:"el-icon-s-grid"}),e._v(" 插入表格 ")])],1)],1)],1),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link"},[e._v(" 主题"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e._l(e.config.pageThemes,(function({value:o,label:n}){return t("el-dropdown-item",{key:n,nativeOn:{click:function(t){return e.pageThemeChanged(o)}}},[t("i",{staticClass:"el-icon-check",style:{opacity:e.currentPageTheme===o?1:0}}),e._v(" "+e._s(n)+" ")])})),t("el-dropdown-item",{staticClass:"padding-left-3",attrs:{divided:""},nativeOn:{click:function(t){return e.customStyle.apply(null,arguments)}}},[e._v(" 自定义 CSS ")]),t("el-dropdown-item",{staticClass:"padding-left-3",nativeOn:{click:function(t){e.showResetConfirm=!0}}},[e._v(" 重置 ")]),t("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(t){return e.statusChanged.apply(null,arguments)}}},[t("i",{staticClass:"el-icon-check",style:{opacity:e.citeStatus?1:0}}),e._v(" 微信外链转底部引用 ")])],2)],1),t("el-button",{attrs:{size:"medium",type:"text"},on:{click:e.copy}},[t("i",{staticClass:"el-icon-document-copy"}),e._v(" 复制 ")]),t("el-button",{attrs:{size:"medium",type:"text"},on:{click:e.share}},[t("i",{staticClass:"el-icon-share"}),e._v(" 分享 ")]),t("reset-dialog",{attrs:{"show-reset-confirm":e.showResetConfirm},on:{confirm:e.confirmReset,close:e.cancelReset}})],1)},X=[],Z=(o("d9e2"),o("c0e9")),ee=o.n(Z),te=o("466b"),oe=o.n(te);function ne(){const e=document.getElementById("output"),t=e.getElementsByTagName("img");for(let o=0;o<t.length;o++){const e=t[o],n=e.getAttribute("width"),i=e.getAttribute("height");e.removeAttribute("width"),e.removeAttribute("height"),e.style.width=n,e.style.height=i}}function ie(e){return oe()(e,{inlinePseudoElements:!0,preserveImportant:!0})}var se=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"reset__dialog",attrs:{title:"提示",visible:e.showResetConfirm,center:""},on:{close:function(t){return e.$emit("close")}}},[t("div",{staticStyle:{"text-align":"center"}},[e._v("此操作将丢失本地自定义样式，是否继续?")]),t("template",{slot:"footer"},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.$emit("close")}}},[e._v(" 取 消 ")]),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.$emit("confirm")}}},[e._v(" 确 定 ")])],1)],2)},re=[],ae={props:{showResetConfirm:{type:Boolean,default:!1}},computed:{}},ce=ae,le=(o("69c7"),o("2877")),de=Object(le["a"])(ce,se,re,!1,null,"8722c9ec",null),ue=de.exports,me=function(){var e=this,t=e._self._c;return t("el-dropdown",{staticClass:"style-option-menu",attrs:{placement:"right"}},[t("div",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(e.label)+" "),t("i",{staticClass:"el-icon-arrow-right el-icon--right"})]),t("el-dropdown-menu",{staticStyle:{width:"200px"},attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.options,(function({value:o,label:n,desc:i}){return t("el-dropdown-item",{key:o,attrs:{label:n,value:o},nativeOn:{click:function(t){return e.charge(o)}}},[t("i",{staticClass:"el-icon-check",style:{opacity:e.current===o?1:0}}),e._v(" "+e._s(n)+" "),t("span",{staticClass:"select-item-right"},[e._v(e._s(i))])])})),1)],1)},pe=[],fe={name:"StyleOptionMenu",props:{label:{type:String,required:!0},options:{type:Array,required:!0},current:{type:String,required:!0},charge:{type:Function,required:!0}}},he=fe,ge=(o("886c"),Object(le["a"])(he,me,pe,!1,null,"bea8408c",null)),be=ge.exports,_e={name:"editor-header",data(){return{config:h,citeStatus:!1,showResetConfirm:!1,form:{dialogVisible:!1,title:"",desc:"",thumb:"",content:""},formatItems:[{label:"加粗",kbd:"Ctrl/Command + B",emitArgs:["addFormat","**"]},{label:"斜体",kbd:"Ctrl/Command + I",emitArgs:["addFormat","*"]},{label:"删除线",kbd:"Ctrl/Command + D",emitArgs:["addFormat","~~"]},{label:"超链接",kbd:"Ctrl/Command + K",emitArgs:["addFormat","[","]()"]},{label:"格式化",kbd:"Ctrl/Command + F",emitArgs:["formatContent"]}]}},components:{StyleOptionMenu:be,ResetDialog:ue},computed:{...Object(r["e"])(Y,{output:e=>e.output,editor:e=>e.editor,cssEditor:e=>e.cssEditor,themes:e=>e.themes,currentPageTheme:e=>e.currentPageTheme,currentCiteStatus:e=>e.citeStatus})},methods:{refClick(){this.$refs.fileInput.click()},pageThemeChanged(e){const t=this.themes[e];this.setWxRendererOptions({theme:t}),this.setCurrentPageTheme(e),this.$emit("refresh")},statusChanged(){this.citeStatus=!this.citeStatus,this.setCiteStatus(this.citeStatus),this.$emit("refresh")},share(){try{let e=i["Loading"].service({fullscreen:!0,text:"图片生成中..."});const t=document.querySelector("#output-wrapper .preview");ee()(t,{allowTaint:!0,useCORS:!0,scale:3,imageTimeout:0}).then(t=>{const o=t.toDataURL(),n=document.createElement("a"),i=new Date,s="page-"+i.getFullYear()+(i.getMonth()+1)+i.getDate()+".png";n.download=s,n.href=o,n.click(),e.close()})}catch(e){throw new Error(e)}},copy(){this.$emit("startCopy"),setTimeout(()=>{ne();const e=document.getElementById("output");e.innerHTML=ie(e.innerHTML),e.innerHTML=e.innerHTML.replace(/class="base"( style="display: inline")*/g,'class="base" style="display: inline"').replace(/top:(.*?)em/g,"transform: translateY($1em)"),e.focus(),window.getSelection().removeAllRanges();let t=document.createRange();t.setStartBefore(e.firstChild),t.setEndAfter(e.lastChild),window.getSelection().addRange(t),document.execCommand("copy"),window.getSelection().removeAllRanges(),e.innerHTML=this.output,this.$notify({showClose:!0,message:"已复制渲染后的文章到剪贴板，可直接到公众号后台粘贴",offset:80,duration:1600,type:"success"}),this.$emit("refresh"),this.$emit("endCopy")},350)},async customStyle(){this.$emit("showCssEditor"),this.$nextTick(()=>{this.cssEditor||this.cssEditor.refresh()}),setTimeout(()=>{this.cssEditor.refresh()},50);let e=localStorage.getItem("__css_content");e||this.setCssEditorValue(E)},confirmReset(){this.showResetConfirm=!1,localStorage.clear(),this.cssEditor.setValue(E),this.citeStatus=!1,this.statusChanged(!1),this.pageThemeChanged(this.config.pageThemes[0].value),this.$emit("cssChanged")},cancelReset(){this.showResetConfirm=!1,this.editor.focus()},...Object(r["d"])(Y,["setCurrentPageTheme","setCiteStatus","setCssEditorValue","setWxRendererOptions"])},mounted(){this.citeStatus=this.currentCiteStatus;const e=this.$refs.fileInput;e.onchange=()=>{const t=e.files[0];if(null==t)return;const o=new FileReader;o.readAsText(t),o.onload=()=>{this.$emit("import-md",o.result)}}}},we=_e,Ce=(o("2679"),Object(le["a"])(we,Q,X,!1,null,"2d7d3b7b",null)),ke=Ce.exports,ye=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"insert__dialog",attrs:{title:"插入表格",visible:e.visible,border:""},on:{close:function(t){return e.$emit("close")}}},[t("el-row",{staticClass:"tb-options",attrs:{type:"flex",align:"middle",gutter:10}},[t("el-col",[e._v(" 行数： "),t("el-input-number",{attrs:{"controls-position":"right",min:1,max:100,size:"small"},model:{value:e.rowNum,callback:function(t){e.rowNum=t},expression:"rowNum"}})],1),t("el-col",[e._v(" 列数： "),t("el-input-number",{attrs:{"controls-position":"right",min:1,max:100,size:"small"},model:{value:e.colNum,callback:function(t){e.colNum=t},expression:"colNum"}})],1)],1),t("table",{staticClass:"input-table",staticStyle:{"border-collapse":"collapse"}},e._l(e.rowNum+1,(function(o){return t("tr",{key:o,class:{"head-style":1===o}},e._l(e.colNum,(function(n){return t("td",{key:n},[t("el-input",{attrs:{align:"center",placeholder:1===o?"表头":""},model:{value:e.tableData[`k_${o-1}_${n-1}`],callback:function(t){e.$set(e.tableData,`k_${o-1}_${n-1}`,t)},expression:"tableData[`k_${row - 1}_${col - 1}`]"}})],1)})),0)})),0),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.$emit("close")}}},[e._v(" 取 消 ")]),t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.insertTable}},[e._v(" 确 定 ")])],1)],1)},Ee=[],ve={props:{visible:{type:Boolean,default:!1}},data(){return{config:h,rowNum:3,colNum:3,tableData:{}}},computed:{...Object(r["e"])(Y,{editor:e=>e.editor})},methods:{insertTable(){this.editor.getCursor();const e=H({data:this.tableData,rows:this.rowNum,cols:this.colNum});this.tableData={},this.rowNum=3,this.colNum=3,this.editor.replaceSelection(`\n${e}\n`,"end"),this.$emit("close"),this.editorRefresh()},...Object(r["d"])(Y,["editorRefresh"])}},xe=ve,Oe=(o("46cc"),Object(le["a"])(xe,ye,Ee,!1,null,"168cf10c",null)),$e=Oe.exports,Se=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"menu",style:`left: ${e.left}px;top: ${e.top}px;`,attrs:{id:"menu"}},e._l(e.menu,(function(o,n){return t("ul",{key:n,staticClass:"menu__group"},e._l(o,(function({key:o,text:n}){return t("li",{key:o,staticClass:"menu_item",on:{mousedown:function(t){return e.onMouseDown(o)}}},[e._v(" "+e._s(n)+" ")])})),0)})),0)},Te=[],Me={props:{visible:{type:Boolean,default:!1},top:{type:Number,default:0},left:{type:Number,default:0}},data(){return{menu:[[{text:"上传图片",key:"insertPic"},{text:"插入表格",key:"insertTable"},{text:"恢复默认样式",key:"resetStyle"}],[{text:"导入 .md 文档",key:"importMarkdown"},{text:"导出 .md 文档",key:"download"},{text:"导出 .html",key:"export"},{text:"格式化",key:"formatMarkdown"}]]}},methods:{onMouseDown(e){this.$emit("menuTick",e),this.$emit("closeMenu")}}},De=Me,Pe=(o("68ad"),Object(le["a"])(De,Se,Te,!1,null,"283cf1ee",null)),Ie=Pe.exports,Ae=function(){var e=this,t=e._self._c;return t("el-dialog",{staticClass:"upload__dialog",attrs:{title:"",visible:e.visible},on:{close:function(t){return e.$emit("close")}}},[t("el-tabs",{attrs:{type:"activeName"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{staticClass:"upload-panel",attrs:{label:"上传",name:"upload"}},[t("el-upload",{attrs:{drag:"",action:"",headers:{"Content-Type":"multipart/form-data"},"show-file-list":!1,multiple:!0,accept:".jpg, .jpeg, .png, .gif",name:"file","before-upload":e.beforeImageUpload,"http-request":e.uploadImage}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v(" 将图片拖到此处，或 "),t("em",[e._v("点击上传")])])])],1),t("el-tab-pane",{staticClass:"github-panel",attrs:{label:"配置 GitHub 图床",name:"github"}},[t("el-form",{staticClass:"setting-form",attrs:{model:e.formGitHub,"label-position":"right","label-width":"140px"}},[t("el-form-item",{attrs:{label:"GitHub 仓库",required:!0}},[t("el-input",{attrs:{placeholder:"如：github.com/yanglbme/resource"},model:{value:e.formGitHub.repo,callback:function(t){e.$set(e.formGitHub,"repo","string"===typeof t?t.trim():t)},expression:"formGitHub.repo"}})],1),t("el-form-item",{attrs:{label:"分支"}},[t("el-input",{attrs:{placeholder:"如：release，可不填，默认 master"},model:{value:e.formGitHub.branch,callback:function(t){e.$set(e.formGitHub,"branch","string"===typeof t?t.trim():t)},expression:"formGitHub.branch"}})],1),t("el-form-item",{attrs:{label:"Token",required:!0}},[t("el-input",{attrs:{"show-password":"",placeholder:"如：cc1d0c1426d0fd0902bd2d7184b14da61b8abc46"},model:{value:e.formGitHub.accessToken,callback:function(t){e.$set(e.formGitHub,"accessToken","string"===typeof t?t.trim():t)},expression:"formGitHub.accessToken"}}),t("el-link",{attrs:{type:"primary",href:"https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token",target:"_blank"}},[e._v("如何获取 GitHub Token？ ")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.saveGitHubConfiguration}},[e._v("保存配置 ")])],1)],1)],1)],1)],1)},Re=[],je={props:{visible:{type:Boolean,default:!1}},data(){return{activeName:"upload",formGitHub:{repo:"",branch:"",accessToken:""},options:[{value:"default",label:"默认"},{value:"github",label:"GitHub"}],imgHost:"github"}},created(){localStorage.getItem("githubConfig")&&(this.formGitHub=JSON.parse(localStorage.getItem("githubConfig")))},methods:{changeImgHost(){localStorage.setItem("imgHost",this.imgHost),this.$message.success("已成功切换图床")},saveGitHubConfiguration(){if(this.formGitHub.repo&&this.formGitHub.accessToken)localStorage.setItem("githubConfig",JSON.stringify(this.formGitHub)),this.$message.success("保存成功");else{const e=this.formGitHub.repo?"token":"GitHub 仓库";this.$message.error(`参数「${e}」不能为空`)}},beforeImageUpload(e){const t=W(e);if(!t.ok)return this.$message.error(t.msg),!1;let o=localStorage.getItem("imgHost");o=o||"default",localStorage.setItem("imgHost",o);const n=localStorage.getItem(o+"Config"),i="default"==o||n;return!!i||(this.$message.error(`请先配置 ${o} 图床参数`),!1)},uploadImage(e){this.$emit("uploadImage",e.file)}},watch:{activeName:{immediate:!0,handler(e){"formCustom"===e&&this.$nextTick(()=>{const e=this.$refs.formCustomElInput.$el.querySelector("textarea");this.formCustom.editor=this.formCustom.editor||f.a.fromTextArea(e,{mode:"javascript"}),this.formCustom.editor.setValue(this.formCustom.code)})}}},mounted(){}},Le=je,Ue=(o("87ea"),Object(le["a"])(Le,Ae,Re,!1,null,"dfd069f0",null)),Be=Ue.exports,qe=function(){var e=this,t=e._self._c;return t("transition",{attrs:{"enter-active-class":"bounceInRight"}},[t("el-col",{directives:[{name:"show",rawName:"v-show",value:e.showCssEditor,expression:"showCssEditor"}],staticClass:"cssEditor-wrapper",attrs:{span:8}},[t("i",{staticClass:"el-icon-close",on:{click:e.close}}),t("textarea",{attrs:{id:"cssEditor",type:"textarea",placeholder:"Your custom css here."}})])],1)},Fe=[],Ke={name:"CssEditor",props:{showCssEditor:{type:Boolean,default:!1}},methods:{close(){this.$emit("showCssEditor")}}},He=Ke,Ge=(o("3ab4"),Object(le["a"])(He,qe,Fe,!1,null,"61592812",null)),We=Ge.exports,Ne=function(){var e=this,t=e._self._c;return e.loading?t("transition",{attrs:{name:"fade"}},[t("div",{staticClass:"loading"},[t("strong",[e._v("致力于让 Markdown 编辑更简单")])])]):e._e()},ze=[],Ve={name:"RunLoading",data(){return{loading:!0}},mounted(){setTimeout(()=>{this.loading=!1},100)}},Je=Ve,Ye=(o("e737"),Object(le["a"])(Je,Ne,ze,!1,null,"2063a41e",null)),Qe=Ye.exports,Xe=o("3f5e");o("f9d4");var Ze={data(){return{showCssEditor:!1,dialogUploadImgVisible:!1,insertFormDialogVisible:!1,isCoping:!1,isImgLoading:!1,backLight:!1,timeout:null,changeTimer:null,source:"",mouseLeft:0,mouseTop:0,rightClickMenuVisible:!1}},components:{CssEditor:We,RunLoading:Qe,EditorHeader:ke,InsertFormDialog:$e,RightClickMenu:Ie,UploadImgDialog:Be},computed:{...Object(r["e"])(Y,{wxRenderer:e=>e.wxRenderer,output:e=>e.output,editor:e=>e.editor,cssEditor:e=>e.cssEditor,currentPageTheme:e=>e.currentPageTheme,themes:e=>e.themes})},created(){this.initEditorState(),this.$nextTick(()=>{this.initEditor(),this.initCssEditor(),this.onEditorRefresh(),this.mdLocalToRemote()})},methods:{mdLocalToRemote(){const e=this,t=this.$refs.codeMirrorWrapper.$el;async function o({list:e}){return new Promise((t,o)=>{const{path:n,file:i}=e.find(e=>e.path.match(/\.md$/)),s=new FileReader;s.readAsText(i,"UTF-8"),s.onload=e=>{t({str:e.target.result,file:i,path:n})}})}async function n({md:t,list:o}){const n=[...t.str.matchAll(/!\[(.*?)\]\((.*?)\)/gm)||[]].filter(e=>e),i=t.path.match(/.+?\//)[0],s=await Promise.all(n.map(t=>new Promise((n,s)=>{let[,,r]=t;r=r.replace(/^.\//,"");const{file:a}=o.find(e=>e.path===`${i}${r}`)||{};e.uploadImage(a,e=>{n({matchStr:r,url:e})})})));s.forEach(e=>{t.str=t.str.replace(`](./${e.matchStr})`,`](${e.url})`).replace(`](${e.matchStr})`,`](${e.url})`)}),e.editor.setValue(t.str),console.log("resList",s,t.str)}async function i(e){const t=[];let o="";try{const n=[e];for(const e of n){o+=e.name+"/";for await(const[,i]of e)"file"===i.kind?t.push({path:o+i.name,file:await i.getFile()}):(t.push({path:o+i.name+"/"}),n.push(i))}}catch(n){console.error(n)}return t}t.ondragover=e=>e.preventDefault(),t.ondrop=async e=>{e.preventDefault();for(const t of e.dataTransfer.items)t.getAsFileSystemHandle().then(async e=>{if("directory"===e.kind){const t=await i(e),s=await o({list:t});n({md:s,list:t})}else{const t=await e.getFile();console.log("file",t)}})}},initEditor(){this.initEditorEntity(),this.editor.on("change",(e,t)=>{this.changeTimer&&clearTimeout(this.changeTimer),this.changeTimer=setTimeout(()=>{this.onEditorRefresh(),U(this.editor,"__editor_content")},300)}),this.editor.on("paste",(e,t)=>{if(t.clipboardData&&t.clipboardData.items&&!this.isImgLoading)for(let o=0,n=t.clipboardData.items.length;o<n;++o){let e=t.clipboardData.items[o];if("file"===e.kind){const t=e.getAsFile(),o=this.beforeUpload(t);if(!o)continue;this.uploadImage(t)}}}),this.editor.on("mousedown",()=>{this.rightClickMenuVisible=!1}),this.editor.on("blur",()=>{
//!影响到右键菜单的点击事件，右键菜单的点击事件在组件内通过mousedown触发
this.rightClickMenuVisible=!1}),this.editor.on("scroll",()=>{this.rightClickMenuVisible=!1})},initCssEditor(){this.initCssEditorEntity(),this.cssChanged(),this.cssEditor.on("keyup",(e,t)=>{(t.keyCode>=65&&t.keyCode<=90||189===t.keyCode)&&e.showHint(t)}),this.cssEditor.on("update",e=>{this.cssChanged(),U(this.cssEditor,"__css_content")})},cssChanged(){let e=L(this.cssEditor.getValue(0)),t=this.themes[this.currentPageTheme];t=j(e,t),this.setWxRendererOptions({theme:t}),this.onEditorRefresh()},beforeUpload(e){const t=W(e);if(!t.ok)return this.$message.error(t.msg),!1;let o=localStorage.getItem("imgHost");o=o||"default",localStorage.setItem("imgHost",o);const n=localStorage.getItem(o+"Config"),i="default"==o||n;return!!i||(this.$message.error(`请先配置 ${o} 图床参数`),!1)},uploadImage(e,t){this.isImgLoading=!0,G(e).then(o=>{console.log(o),Xe["a"].fileUpload(o,e).then(e=>{console.log(e),t?t(e):this.uploaded(e)}).catch(e=>{this.$message.error(e.message)})}).catch(e=>{this.$message.error(e.message)}),this.isImgLoading=!1},uploaded(e){if(console.log("图片上传之后: ",e),!e)return void this.$message.error("上传图片未知异常");this.dialogUploadImgVisible=!1;const t=this.editor.getCursor(),o=e,n=`![](${o})`;this.editor.replaceSelection(`\n${n}\n`,t),this.$message.success("图片上传成功"),this.onEditorRefresh()},leftAndRightScroll(){const e=e=>{let n,i;clearTimeout(this.timeout),"preview"===e?(n=this.$refs.preview.$el,i=document.getElementsByClassName("CodeMirror-scroll")[0],this.editor.off("scroll",t),this.timeout=setTimeout(()=>{this.editor.on("scroll",t)},300)):"editor"===e&&(n=document.getElementsByClassName("CodeMirror-scroll")[0],i=this.$refs.preview.$el,i.removeEventListener("scroll",o,!1),this.timeout=setTimeout(()=>{i.addEventListener("scroll",o,!1)},300));let s=n.scrollTop/(n.scrollHeight-n.offsetHeight),r=s*(i.scrollHeight-i.offsetHeight);i.scrollTo(0,r)},t=()=>{e("editor")},o=()=>{e("preview")};this.$refs.preview.$el.addEventListener("scroll",o,!1),this.editor.on("scroll",t)},onEditorRefresh(){this.editorRefresh(),setTimeout(()=>window.PR.prettyPrint(),0)},endCopy(){this.backLight=!1,setTimeout(()=>{this.isCoping=!1},800)},addFormat(e,t=e){const{head:o,anchor:n}=this.editor.doc.sel.ranges[0];let i,s;o.line===n.line?o.ch<n.ch?(i=o,s=n):(i=n,s=o):o.line<n.line?(i=o,s=n):(i=n,s=o);const r=[];let a="";for(const l of this.editor.getValue())"\n"===l?(r.push(a),a=""):a+=l;r.push(a);let c="";for(let l=0;l<r.length;l++){const o=r[l];for(let n=0;n<o.length;n++)l===i.line&&n===i.ch&&(c+=e),l===s.line&&n===s.ch&&(c+=t),c+=o[n];l===s.line&&o.length===s.ch&&(c+=t),c+="\n"}this.editor.setValue(c)},importMD(e){this.editor.setValue(e),this.onEditorRefresh()},downloadEditorContent(){F(this.editor.getValue(0))},exportEditorContent(){this.$nextTick(()=>{K(),document.getElementById("output").innerHTML=this.output})},importMarkdownContent(){let e=document.getElementById("menu"),t=document.createElement("input");t.type="file",t.name="filename",t.accept=".txt,.md",e.appendChild(t),t.onchange=()=>{if(!t.files)return;const e=t.files[0];if(!/\.(txt|TXT|MD|md)$/.test(e.name))return void this.$message.error("不支持的文档格式");const o=new FileReader;o.readAsText(e),o.onload=e=>{let t=e.target.result;t=B(t),t&&(localStorage.setItem("__editor_content",t),this.editor.setValue(t),this.$message.success("文档导入成功"))}},t.click(),e.removeChild(t)},formatContent(){const e=B(this.editor.getValue(0));localStorage.setItem("__editor_content",e),this.editor.setValue(e)},openMenu(e){const t=105,o=this.$el.getBoundingClientRect().left,n=this.$el.offsetWidth,i=n-t,s=e.clientX-o;this.mouseLeft=Math.min(i,s),this.mouseTop=e.clientY+10,this.rightClickMenuVisible=!0},onMenuEvent(e){switch(e){case"resetStyle":this.$refs.header.showResetConfirm=!0;break;case"insertPic":this.dialogUploadImgVisible=!0;break;case"download":this.downloadEditorContent();break;case"export":this.exportEditorContent();break;case"insertTable":this.insertFormDialogVisible=!0;break;case"importMarkdown":this.importMarkdownContent();break;case"formatMarkdown":this.formatContent();break;default:break}},...Object(r["d"])(Y,["initEditorState","initEditorEntity","setWxRendererOptions","editorRefresh","initCssEditorEntity"])},mounted(){setTimeout(()=>{this.leftAndRightScroll(),window.PR.prettyPrint()},300)}},et=Ze,tt=(o("5fc7"),o("b90a8"),Object(le["a"])(et,l,d,!1,null,"4e63cd9e",null)),ot=tt.exports,nt={__name:"App",setup(e){return{__sfc:!0,CodemirrorEditor:ot}}},it=nt,st=(o("4d32"),Object(le["a"])(it,a,c,!1,null,null,null)),rt=st.exports;n["default"].use(s.a).use(r["a"]),n["default"].config.productionTip=!1,rt.mpType="app",new n["default"]({...rt,pinia:Object(r["b"])()}).$mount("#app")},"5b20":function(e,t,o){},"5fc7":function(e,t,o){"use strict";o("5b20")},6:function(e,t){},"68ad":function(e,t,o){"use strict";o("9c20")},"69c7":function(e,t,o){"use strict";o("ebee")},7:function(e,t){},"75fb":function(e,t,o){},8:function(e,t){},"80b4":function(e,t,o){},"87ea":function(e,t,o){"use strict";o("80b4")},"886c":function(e,t,o){"use strict";o("99b0")},9:function(e,t){},"90ba":function(e,t,o){},"99b0":function(e,t,o){},"9c20":function(e,t,o){},aede:function(e,t,o){},b1cf:function(e,t,o){},b90a8:function(e,t,o){"use strict";o("aede")},c403:function(e,t,o){},da71:function(e,t,o){"use strict";o.d(t,"b",(function(){return n})),o.d(t,"a",(function(){return i}));const n={username:"filess",repoList:Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],e=>"img"+e),branch:"main",accessTokenList:["7715d7ca67b5d3837cfdoocsmde8c38421815aa423510af","c411415bf95dbe39625doocsmd5047ba9b7a2a6c9642abe","2821cd8819fa345c053doocsmdca86ac653f8bc20db1f1b","445f0dae46ef1f2a4d6doocsmdc797301e94797b4750a4c","cc1d0c1426d0fd0902bdoocsmdd2d7184b14da61b86ec46","b67e9d15cb6f910492fdoocsmdac6b44d379c953bb19eff","618c4dc2244ccbbc088doocsmd125d17fd31b7d06a50cf3","a4b581732e1c1507458doocsmdc5b223b27dae5e2e16a55","77904db41aee57ad79bdoocsmd760f848201dac9c96fd5e","02f251cb14ac62ab100doocsmdddbfc8527d773f1f04ce1","eb321079a95ba7028d9doocsmde2e84c502dac70de7cf08","22f74fcfb071a961fa2doocsmde28dabc746f0503a15e5d","85124c2bfe7abba0938doocsmd0af7f67918b99d085a5fd","0a561b4d4bbecb2de7edoocsmdd9ba3833d11dbc5e430f5","e8a01491188d8d5a097doocsmd03ede0aad1fe9e3af24e9","36e1f420d7e5bdebd67doocsmd65463562f5f25b20b8377"]},i={username:"filesss",repoList:Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],e=>"img"+e),branch:"main",accessTokenList:["ed5fc9866bd6c2fdoocsmddd433f806fd2f399c","5448ffebbbf1151doocsmdc4e337cf814fc8a62","25b05efd2557ca2doocsmd75b5c0835e3395911","11628c7a5aef015doocsmd2eeff9fb9566f0458","cb2f5145ed938dedoocsmdbd063b4ed244eecf8","d8c0b57500672c1doocsmd55f48b866b5ebcd98","78c56eadb88e453doocsmd43ddd95753351771a","03e1a688003948fdoocsmda16fcf41e6f03f1f0","c49121cf4d191fbdoocsmdd6a7877ed537e474a","adfeb2fadcdc4aadoocsmdfe1ee869ac9c968ff","116c94549ca4a0ddoocsmd192653af5c0694616","ecf30ed7f2eb184doocsmd51ea4ec8300371d9e","5837cf2bd5afd93doocsmd73904bed31934949e","b5b7e1c7d57e01fdoocsmd5266f552574297d78","684d55564ffbd0bdoocsmd7d747e5cc23aed6d6","3fc04a9d272ab71doocsmd010c56cb57d88d2ba"]}},e1d2:function(e,t,o){"use strict";var n=o("cee4");const i=n["a"].create({baseURL:"",timeout:3e4});i.interceptors.request.use(e=>(/^(post)|(put)|(delete)$/i.test(e.method)&&e.data&&e.data.upload&&(e.headers["Content-Type"]="multipart/form-data"),e),e=>{Promise.reject(e)}),i.interceptors.response.use(e=>e.data?e.data:Promise.reject(e),e=>Promise.reject(e)),t["a"]=i},e737:function(e,t,o){"use strict";o("04b9")},ebee:function(e,t,o){}});